<template name="bookingsForCourse">
    <h1>Anmälningar till <a href="/admin/course/{{shortName}}">{{name}}</a></h1>

    <ul>
        <li>
            Publik anmälningssida:
            <a href="{{registrationUrl}}">{{registrationUrl}}</a>
        </li>
        <li>
            Det finns just nu <b>{{bookingCount}}</b> anmälda
            (av max {{bookingLimit}}).
        </li>
        <li>
            <a href="/admin/unpaidBookings/{{shortName}}">Betalstatus</a>
        </li>
        <li>
            <a href="/admin/export/{{shortName}}">Exportera till excel</a>
        </li>
        <!-- TODO
        <li>
            <%= link_to 'Lägg upp en ny anmälan manuellt', "/admin/bookings/new?course=#{@course.id}" %>
            <%= raw tip("I normalfallet bör du använda den publika anmälningssidan, eftersom felhanteringen är bättre där.") %>
        </li>
        -->

        <!--
        TODO
        <li>
            <form action="/admin/print_bookings">
                <input type="hidden" name="course" value="<%=@course.id%>">
                Skriv ut deltagarlista för <select name="date_period">
                <% @course.slot_date_periods.each do |date_period| %>
                <option value="<%=date_period%>"><%= date_period %></option>
                <% end %>
            </select>
                <input type="submit" value="Skriv ut">
            </form>
        </li>
        -->
    </ul>



    {{#if slots.count}}

        {{#each slots}}
            <div class="slot-bookings-section">

                <div class="slot-name">
                    {{name}}
                </div>
                {{> slotAvailability}}

                {{#if bookingCount}}
                    <div class="bookings-table">
                        <table class="data-table">
                            <tr>
                                <th>Förnamn</th>
                                <th>Efternamn</th>
                                <th>Betalat?</th>
                                <th>Personnummer</th>
                                <th>Postnummer</th>
                                <th>Medlemsnummer</th>
                                <th>Epost</th>
                                <th>Telefon</th>
                                <th>Kommentar</th>
                            </tr>

                            {{#each bookings}}
                                <tr>
                                    {{> inPlace collection=Bookings field="childFirstName" doc=this}}
                                    {{> inPlace collection=Bookings field="childLastName" doc=this}}

                                    <td>{{> paymentStatusButtons}}</td>
                                    {{> inPlace collection=Bookings field="childPersonNumber" doc=this}}
                                    {{> inPlace collection=Bookings field="childZip" doc=this}}
                                    {{> inPlace collection=Bookings field="childMembershipNumber" doc=this}}
                                    {{> inPlace collection=Bookings field="parentEmail" doc=this}}
                                    {{> inPlace collection=Bookings field="parentPhone" doc=this}}
                                    {{> inPlace collection=Bookings field="comment" doc=this}}
                                    <td>
                                        <button class="btn btn-warning btn-xs changeSlotButton" data-bookingid="{{_id}}">Byt grupp</button>
                                    </td>
                                    <td>
                                        <button class="btn btn-danger btn-xs removeButton" data-bookingid="{{_id}}">Avanmäl</button>
                                    </td>
                                </tr>
                            {{/each}}
                        </table>
                    </div>
                {{/if}}
            </div>

        {{/each}}



    {{/if}}


</template>