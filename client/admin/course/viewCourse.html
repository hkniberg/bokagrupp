<template name="viewCourse">
    <h1>{{name}}</h1>

    <ul>
        <li>Publik anmälningssida: <a href="{{courseRegistrationUrl}}">{{courseRegistrationUrl}}</a></li>
        <li>Det finns just nu <a href="/admin/bookings/{{shortName}}">{{bookingCount}} anmälda</a> (av max {{bookingLimit}})</li>

        {{#if slots.count}}
            <li><a href="/admin/addBooking/{{shortName}}">Lägg upp ny anmälan manuellt</a></li>
        {{/if}}

        <li><a href="/admin/editCourse/{{shortName}}">Redigera kurs</a></li>
        <li><a href="/admin/course/{{shortName}}/levels">Redigera nivåer</a></li>

        {{#if slots.count}}
            <li><a href="/admin/unpaidBookings/{{shortName}}">Betalstatus</a></li>
            <li><a href="/admin/export/{{shortName}}">Exportera till Excel</a></li>
            <li>
                Skriv ut deltagarlista för: {{> datePeriodSelect}}
                {{#if selectedDatePeriod}}
                    <button class="button btn-success btn-sm printBookingsButton">Skriv ut</button>
                {{/if}}
            </li>
        {{/if}}
    </ul>

    {{#if slots.count}}
        <h2>Grupper</h2>

        <table class="data-table">
            <tr>
                <th>Nivå</th>
                <th>Datumperiod</th>
                <th>Tid</th>
                <th>Max platser</th>
                <th>Anmälda</th>
            </tr>

            {{#each slots}}
                <tr>
                    <td>{{levelName}}</td>
                    {{> inPlace collection=Slots field="datePeriod" doc=this}}
                    {{> inPlace collection=Slots field="time" doc=this}}
                    {{> inPlace collection=Slots field="limit" doc=this}}
                    <td>
                        <a href="/admin/bookings/{{../shortName}}">{{bookingCount}}</a>
                        {{#unless bookingCount}}
                            <button style="margin-left: 5px;" data-slotid="{{_id}}" class="btn btn-xs btn-danger removeSlotButton">Radera grupp</button>
                        {{/unless}}
                    </td>
                </tr>
            {{/each}}
        </table>

    {{/if}}

    {{#if levels.count}}
        <div class="well">
            <h2>Skapa ny grupp</h2>

            {{#autoForm collection=Slots id="addSlotForm" type="method" meteormethod="addSlot"}}
                {{> afQuickField name='courseId' type='hidden' value=_id}}
                {{> afQuickField name='levelId' options=levelSelectValues }}
                {{> afQuickField name='datePeriod'}}
                {{> afQuickField name='time'}}
                {{> afQuickField name='limit'}}
                <button type="submit" class="btn btn-primary">Skapa grupp</button>
            {{/autoForm}}

        </div>
    {{else}}
        <p class="alert alert-danger">Skapa minst en nivå för att kunna lägga upp grupper här.</p>
    {{/if}}

    {{#unless bookingCount}}
        <button class="btn btn-danger removeButton">Ta bort kurs</button>
    {{/unless}}

</template>